<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>
  <!-- google fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Edu+TAS+Beginner:wght@500&family=Merriweather:wght@300&family=Montserrat:wght@100&family=Poppins:wght@200&family=Sacramento&family=Satisfy&display=swap"
    rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css">
  <!-- css links -->
  <link rel="stylesheet" href="/CSS/login.css">
</head>

<body>
  <div class="page">
    <a href="/HTML/index.html" class="logo-link"><img class="logo" src="/media/logo-gamepage.gif" alt=""></a>
    <div class="login">
      <form action="" method="" id="loginForm" class="login-form">
        <h1 class="title">Login</h1>
        <div class="login-fields">
          <div class="login-box">
            <input type="text" name="name" placeholder="enter user name" required class="login-input">
            <i class="ri-mail-fill"></i>
          </div>
  
          <div class="login-box">
            <input type="password" name="password" placeholder="Password" required class="login-input">
            <i class="ri-lock-fill"></i>
          </div>
  
          <button class="login-button" type="submit">Login</button>
          <div class="separator">
            <hr class="line">
          </div>
        </div>
        <div class="sign-up">
          <div class="register">
            Don't have an account? <a href="/HTML/signup.html">Sign up</a>
          </div>
        </div>
      </form>
  </div>
  </div>

<script>
  document.getElementById('loginForm').addEventListener('submit', async (event) => {
    event.preventDefault(); // Prevent form submission

    const formData = new FormData(event.target); // Get form data
    const name = formData.get('name');
    const password = formData.get('password');
    
    // try {
      const response = await fetch('/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ name, password })
      });

      const responseData = await response.json();
      console.log(responseData);
      if (response.ok) {
        // Store token in local storage
        sessionStorage.setItem('token', responseData.token);
        console.log(sessionStorage.getItem('token'));
        // Redirect or update UI as needed
        console.log("%%");
        window.location.href='/HTML/profile.html';
       } 
    //else {
    //     console.error('Login failed:', responseData.message);
    //     // Display error message to the user
    //   }
    // } catch (error) {
    //   console.error('Error during login:', error.message);
    //   // Handle any network or server errors
     
  });
 
</script>
</body>

</html>
